<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DOC</title>
  </head>
  <body>
    <p>
      FIRST NAME: <%= `${y}` %><br />
      LAST NAME: <%= `${z}` %><br/>
      ID: <%= `${id}` %><br/>
    </p>
    <form action="/patient/<%= `${id}` %>" method="POST">
    
        <canvas id="signature" width="300" height="100"></canvas>
      </div>
      <div>Therapist Signature <img src= <%= `${x}` %> />
      <hr />
      <div>
        <canvas id="signaturep" width="300" height="100"></canvas>
      </div>
      <hr />
      <div>Patient Signature<input type="hidden" name="signaturep" /></div>

      <input type="submit" value="Submit" />
    </form>

    <script>
      // patients sig
       var canvasp = document.getElementById("signaturep");
      var ctxp = canvasp.getContext("2d");
      var drawingp = false;
      var prevXp, prevYp;
      var currXp, currYp;
      var signaturep = document.getElementsByName("signaturep")[0];

      canvasp.addEventListener("mousemove", drawP);
      canvasp.addEventListener("mouseup", stopP);
      canvasp.addEventListener("mousedown", startP);
      function startP(e) {
        drawingp = true;
        console.log(drawingp)
      }
      function stopP() {
        drawingp = false;
        prevXp = prevYp = null;
        signaturep.value = canvasp.toDataURL();

      }
      function drawP(e) {
        console.log(e)
        console.log("H!")
        if (!drawingp) {
          return;
        }

        // Test for touchmove event, this requires another property.
        var clientXp = e.type === "touchmove" ? e.touches[0].clientXp : e.clientX;
        var clientYp = e.type === "touchmove" ? e.touches[0].clientYp : e.clientY;

        currXp = clientXp - canvasp.offsetLeft;

        currYp = clientYp - canvasp.offsetTop;
        if (!prevXp && !prevYp) {
          prevXp = currXp;
          prevYp = currYp;
        }

        ctxp.beginPath();
        ctxp.moveTo(prevXp, prevYp);
        ctxp.lineTo(currXp, currYp);
        ctxp.strokeStyle = "black";
        ctxp.lineWidth = 2;
        ctxp.stroke();
        ctxp.closePath();

        prevXp = currXp;
        prevYp = currYp;
      }

      //therapist sig
      // var canvas = document.getElementById("signature");
      // var ctx = canvas.getContext("2d");
      // var drawing = false;
      // var prevX, prevY;
      // var currX, currY;
      // var signature = document.getElementsByName("signature")[0];

      // canvas.addEventListener("mousemove", draw);
      // canvas.addEventListener("mouseup", stop);
      // canvas.addEventListener("mousedown", start);

      // function start(e) {
      //   drawing = true;
      // }

      // function stop() {
      //   drawing = false;
      //   prevX = prevY = null;
      //   signature.value = canvas.toDataURL();
      // }

      // function draw(e) {
      //   if (!drawing) {
      //     return;
      //   }
      //   // Test for touchmove event, this requires another property.
      //   var clientX = e.type === "touchmove" ? e.touches[0].clientX : e.clientX;
      //   var clientY = e.type === "touchmove" ? e.touches[0].clientY : e.clientY;
      //   currX = clientX - canvas.offsetLeft;
      //   console.log(currX);
      //   currY = clientY - canvas.offsetTop;
      //   if (!prevX && !prevY) {
      //     prevX = currX;
      //     prevY = currY;
      //   }

      //   ctx.beginPath();
      //   ctx.moveTo(prevX, prevY);
      //   ctx.lineTo(currX, currY);
      //   ctx.strokeStyle = "black";
      //   ctx.lineWidth = 2;
      //   ctx.stroke();
      //   ctx.closePath();

      //   prevX = currX;
      //   prevY = currY;
      // }
    </script>

   
    
  </body>
</html>
